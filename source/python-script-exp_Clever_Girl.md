---
title: python script exp Clever Girl (snippet)
date: 2020-03-03
tags: ["python"]
---
Python script 'exp Clever Girl'


## python exp Clever Girl

Python mysql example: exp Clever Girl

```python
from Crypto.Util.number import *
from gmpy2 import iroot

n = 161010103536746712075112156042553283066813155993777943981946663919051986586388748662616958741697621238654724628406094469789970509959159343108847331259823125490271091357244742345403096394500947202321339572876147277506789731024810289354756781901338337411136794489136638411531539112369520980466458615878975406339
c = 64166146958225113130966383399465462600516627646827654061505253681784027524205938322376396685421354659091159523153346321216052274404398431369574383580893610370389016662302880230566394277969479472339696624461863666891731292801506958051383432113998695237733732222591191217365300789670291769876292466495287189494
X = 153801856029563198525204130558738800846256680799373350925981555360388985602786501362501554433635610131437376183630577217917787342621398264625389914280509
Y = 8086061902465799210233863613232941060876437002894022994953293934963170056653232109405937694010696299303888742108631749969054117542816358078039478109426
e = 0x20002

# p^2 - (X + 2Y + 1)p -n = 0
delta = pow(X + 2 * Y + 1, 2) + 4 * n
tmp = iroot(delta, 2)
# print(tmp)
p = ((X + 2 * Y + 1) + tmp[0]) / 2
q = n // p
assert (isPrime(p) & isPrime(q) == 1)
print("p:", p)
print("q:", q)

phi_n = (p - 1) * (q - 1)
g = GCD(e, phi_n)
# print(g)
d = inverse(e // g, phi_n)
gth_power_m = pow(c, d, n)
res = iroot(gth_power_m, g)
assert (res[1] == 1)
m = res[0]
print(long_to_bytes(m))


```

## Python links

- Learn Python: https://pythonbasics.org/
- Python Tutorial: https://pythonspot.com
